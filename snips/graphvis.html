<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

  <style>
    body{
      background-color: black;
      color:white;
    }
  </style>


</head>
<body>

<svg id="mySvg" width="800" height="600" ></svg>

<script>



  const N_nodes = 100

  let graph = {
    nodes: Array.from({length: N_nodes}, (_, i) => ({id: i+1, label: 'Node '+(i+1),
      x: Math.random() * 800, y: Math.random() * 600})),

    
    edges: Array.from({length: N_nodes}, (_, i) => ({from: i+1, to: Math.floor(Math.random() * N_nodes) + 1}))
  }

  graph = {...graph, nodes: graph.nodes.map(node => ({...node, x: Math.random() * 800, y: Math.random() * 600}))}

  const svg = document.querySelector('#mySvg');
  svg.setAttribute('width', '1000');
  svg.setAttribute('height', '1000');
  
  document.body.appendChild(svg);


  let selected_nodes = []

  function shownode(node){

    let dot = document.createElementNS('http://www.w3.org/2000/svg', 'circle')
    dot.setAttribute('r', '5')
    dot.setAttribute('stroke', 'white')
    dot.setAttribute('fill', selected_nodes.includes(node) ? 'white' : 'gray')
    dot.setAttribute('id', 'node'+node.id)
    dot.setAttribute('label', node.label)

    dot.setAttribute('cx', node.x)
    dot.setAttribute('cy', node.y)
    svg.appendChild(dot)
    return dot
  }

  function connectnodes(a, b){
    let line = document.createElementNS('http://www.w3.org/2000/svg', 'line')
    line.setAttribute('x1', a.x)
    line.setAttribute('y1', a.y)
    line.setAttribute('x2', b.x)
    line.setAttribute('y2', b.y)
    line.setAttribute('stroke', (selected_nodes.includes(a) || selected_nodes.includes(b)) ? 'white' : 'gray')
    svg.appendChild(line)
    return line
  }


  function show(){
    svg.innerHTML = ''
    graph.edges.map(edge=>connectnodes(graph.nodes[edge.from-1], graph.nodes[edge.to-1]))
    graph.nodes.map(node => shownode(node))
  }

  show()

  let dragstart = undefined
  let mousepressed = false

  document.addEventListener('mousedown', e=>{
    if (e.target.id && e.target.id.startsWith('node'))
      selected_nodes = graph.nodes.filter(node => node.id == e.target.id.replace('node', ''))

    mousepressed=true
    show()
  })
  document.addEventListener('mouseup', e=>{mousepressed=false})
  document.addEventListener('mousemove', e=>{
    if (mousepressed){
      selected_nodes.forEach(node => {
        node.x = e.clientX-10
        node.y = e.clientY-10
      })
      show()
    }
  })

</script>
  
</body>
</html>