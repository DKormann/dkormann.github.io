<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

  <style>
    body{
      background-color: black;
      color:white;
    }
  </style>


</head>
<body>

<svg id="mySvg" width="800" height="600" ></svg>

<script>


  /**
   *
   * @type {{nodes: {id: number, label: string}[], edges: {from: number, to: number}[]}}
   */
  // let graph = {
  //   nodes: [
  //     {id: 1, label: 'Node 1'},
  //     {id: 2, label: 'Node 2'},
  //     {id: 3, label: 'Node 3'},
  //     {id: 4, label: 'Node 4'},
  //     {id: 5, label: 'Node 5'}
  //   ],
  //   edges: [
  //     {from: 1, to: 2},
  //     {from: 1, to: 3},
  //     {from: 2, to: 4},
  //     {from: 2, to: 5}
  //   ]
  // };


  const N_nodes = 100

  let graph = {
    nodes: Array.from({length: N_nodes}, (_, i) => ({id: i+1, label: 'Node '+(i+1),
      x: Math.random() * 800, y: Math.random() * 600})),

    
    edges: Array.from({length: N_nodes}, (_, i) => ({from: i+1, to: Math.floor(Math.random() * N_nodes) + 1}))
  }

  graph = {...graph, nodes: graph.nodes.map(node => ({...node, x: Math.random() * 800, y: Math.random() * 600}))}

  const svg = document.querySelector('#mySvg');
  svg.setAttribute('width', '1000');
  svg.setAttribute('height', '1000');
  
  document.body.appendChild(svg);

  function shownode(node){


    let dot = document.createElementNS('http://www.w3.org/2000/svg', 'circle')
    dot.setAttribute('r', '5')
    dot.setAttribute('stroke', 'white')
    dot.setAttribute('fill', 'white')
    dot.setAttribute('id', 'node'+node.id)
    dot.setAttribute('label', node.label)

    dot.setAttribute('cx', node.x)
    dot.setAttribute('cy', node.y)
    svg.appendChild(dot)
    return dot
  }

  function connectnodes(a, b){
    let line = document.createElementNS('http://www.w3.org/2000/svg', 'line')
    line.setAttribute('x1', a.getAttribute('cx'))
    line.setAttribute('y1', a.getAttribute('cy'))
    line.setAttribute('x2', b.getAttribute('cx'))
    line.setAttribute('y2', b.getAttribute('cy'))
    line.setAttribute('stroke', 'white')
    svg.appendChild(line)
    return line
  }


  function show(){
    svg.innerHTML = ''
    let dots = graph.nodes.map(node => shownode(node))
    let lines = graph.edges.map(edge => connectnodes(dots[edge.from - 1], dots[edge.to - 1]))
  }

  show()

  let selected_nodes = []

  let dragstart = undefined

  let mousepressed = false

  document.addEventListener('click', e=>{

  })
  
  document.addEventListener('mousedown', e=>{
    if (e.target.id && e.target.id.startsWith('node')){
      selected_nodes = graph.nodes.filter(node => node.id == e.target.id.replace('node', ''))
    }
    mousepressed=true
  })
  document.addEventListener('mouseup', e=>{mousepressed=false})

  document.addEventListener('mousemove', e=>{
    if (mousepressed){
      selected_nodes.forEach(node => {
        node.x = e.clientX
        node.y = e.clientY
      })
      show()
    }
  })


</script>
  
</body>
</html>